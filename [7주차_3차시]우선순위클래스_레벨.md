# 우선순위 클래스(Priority Class)와 우선순위 레벨(Thread Priority Level)

- `Windows`의 스레드 우선순위 두 가지 개념
    - 우선순위 클래스(Priority Class)와 **우선순위 레벨(Thread Priority Level)**
    - 이 두 가지가 합쳐져 실제 CPU 스케줄링 우선순위를 결정

---

## 1. 프로세스의 우선순위 클래스 (Priority Class)

- 프로세스 전체의 기본 우선순위 범위 지정.
    - Windows는 프로세스 단위로 **기본 우선순위 범위** 설정
    - API: `SetPriorityClass()`, `GetPriorityClass()`

| 우선순위 클래스 상수 | 설명 | 기본 스레드 우선순위 |
| --- | --- | --- |
| `IDLE_PRIORITY_CLASS` | 시스템이 한가할 때만 실행 (백그라운드용) | `THREAD_PRIORITY_IDLE` |
| `BELOW_NORMAL_PRIORITY_CLASS` | 보통보다 낮음 | `THREAD_PRIORITY_BELOW_NORMAL` |
| `NORMAL_PRIORITY_CLASS` | 일반 앱 기본값 | `THREAD_PRIORITY_NORMAL` |
| `ABOVE_NORMAL_PRIORITY_CLASS` | 보통보다 높음 | `THREAD_PRIORITY_ABOVE_NORMAL` |
| `HIGH_PRIORITY_CLASS` | 중요한 작업용 (예: 실시간 그래픽) | `THREAD_PRIORITY_NORMAL` |
| `REALTIME_PRIORITY_CLASS` | 실시간 프로세스 (시스템 위험할 수 있음) | `THREAD_PRIORITY_NORMAL` |
- **예**

```c
SetPriorityClass(GetCurrentProcess(), HIGH_PRIORITY_CLASS);

```

---

## 2. 스레드의 우선순위 레벨 (Thread Priority Level)

- **같은 프로세스 안에서 스레드 간의 상대적 우선순위를 조정**
    - API: `SetThreadPriority()`, `GetThreadPriority()`

| 상수 | 상대적 수준 | 설명 |
| --- | --- | --- |
| `THREAD_PRIORITY_IDLE` | 최저 | 거의 실행 안 됨 |
| `THREAD_PRIORITY_LOWEST` | 낮음 |  |
| `THREAD_PRIORITY_BELOW_NORMAL` | 보통보다 약간 낮음 |  |
| `THREAD_PRIORITY_NORMAL` | 기본값 | 대부분 스레드의 기본 |
| `THREAD_PRIORITY_ABOVE_NORMAL` | 보통보다 높음 |  |
| `THREAD_PRIORITY_HIGHEST` | 매우 높음 |  |
| `THREAD_PRIORITY_TIME_CRITICAL` | 최상 | CPU 독점 가능성 있음 |
- **예**

```c
SetThreadPriority(hThread, THREAD_PRIORITY_ABOVE_NORMAL);

```

---

## 3. 우선순위 계산

- Windows는 내부적으로 “**기본 우선순위 클래스 + 스레드 우선순위 레벨**”을 합쳐서 0~31 사이의 **실제 스케줄링 우선순위 (base priority)**를 결정

| 프로세스 클래스 | THREAD_PRIORITY_NORMAL | THREAD_PRIORITY_HIGHEST | THREAD_PRIORITY_TIME_CRITICAL |
| --- | --- | --- | --- |
| IDLE_PRIORITY_CLASS | 4 | 6 | 15 |
| NORMAL_PRIORITY_CLASS | 8 | 10 | 15 |
| HIGH_PRIORITY_CLASS | 13 | 15 | 15 |
| REALTIME_PRIORITY_CLASS | 24 | 26 | 31 |

---

| 구분 | 적용 대상 | 설정 함수 | 설명 |
| --- | --- | --- | --- |
| 우선순위 클래스 | 프로세스 | `SetPriorityClass()` | 프로세스의 전체 기본 우선순위 범위 |
| 우선순위 레벨 | 스레드 | `SetThreadPriority()` | 같은 프로세스 안에서 상대적 스레드 우선순위 |

---

## 코드

```c
#include <windows.h>
#include <stdio.h>

DWORD WINAPI MyThread(LPVOID arg)
{
    for (int i = 0; i < 10; i++) {
        printf("스레드 동작 중... (%d)\n", i);
        Sleep(500);
    }
    return 0;
}

int main(void)
{
    HANDLE hThread = CreateThread(NULL, 0, MyThread, NULL, 0, NULL);

    // 프로세스 우선순위: 높음
    SetPriorityClass(GetCurrentProcess(), HIGH_PRIORITY_CLASS);

    // 스레드 우선순위: 보통보다 높음
    SetThreadPriority(hThread, THREAD_PRIORITY_ABOVE_NORMAL);

    WaitForSingleObject(hThread, INFINITE);
    CloseHandle(hThread);
    return 0;
}

```

---
